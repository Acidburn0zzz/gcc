#!/bin/ksh

COMPILERDIR=/import/dr3/gcc2ir_blds_s10

if [ $# -ne 0 -a $# -ne 1 ]
then
        echo 'Usage: $0  [<buildid>]'
        echo 'where <buildid> is the id of the build to which to set that current'
        echo 'If <buildid> is not specified, the latest build of that release is used.'
        exit 1
fi


cd $COMPILERDIR

if [ $# -eq 0 ]
then
        # Make the latest build of this release current.
        latest=`/bin/ls -d *_gcc 2> /dev/null | grep -v current_mars_gcc | awk '{last=$1}; END { print last }'`

        if [ "$latest" = "" ]
        then
                echo "No compiler exists for train $TRAIN."
                exit 2
        fi
else    # Make the specified build current.
        if [ ! -a "$1" ]
        then
                echo "Compiler $1 does not exist."
                exit 3
        fi
        latest="$1"
fi

rm -f current_mars_gcc
ln -s $latest current_mars_gcc

echo Build $COMPILERDIR/$latest is now current_mars_gcc for Solaris 10.
